<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><title>ext2</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script><script language=JavaScript src="../javascript/searchdata.js"></script></head><body class="ContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.4 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CFile"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="ext2"></a>ext2</h1><div class=CBody><p>by august0815 19.12.2009</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#ext2" >ext2</a></td><td class=SDescription>by august0815 19.12.2009</td></tr><tr class="SGroup"><td class=SEntry><a href="#Functions" >Functions</a></td><td class=SDescription></td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#U.(u--)TESTED_OK" >U.&nbsp; ( u -- ) TESTED_OK</a></td><td class=SDescription>Displays an unsigned number</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#S(--)TESTED_OK" >.S  ( -- )  TESTED_OK</a></td><td class=SDescription>FORTH word .S prints the contents of the stack. </td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#ID.(anf--)TESTED_OK" >ID.&nbsp; ( anf -- )  TESTED_OK</a></td><td class=SDescription>Displays the name of a word from its name field address</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#HIDDEN(--)NOT_TESTED_OK" >?HIDDEN  ( --) NOT TESTED_OK</a></td><td class=SDescription>Vocabulary containing words used only to implement other words</td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#IMMEDIATE_NOT_TESTED_OK" >?IMMEDIATE NOT TESTED_OK</a></td><td class=SDescription>?IMMEDIATE</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#WORDS(--)TESTED_OK" >WORDS ( -- )  TESTED_OK</a></td><td class=SDescription>Displays the words in the context vocabulary</td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#FORGET;(NOT)TESTED_OK" >FORGET ; (NOT) TESTED_OK</a></td><td class=SDescription>&lsquo;FORGET word&rsquo; deletes the definition of &lsquo;word&rsquo; from the dictionary and everything defined after it, including any variables and other memory allocated after.</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#UWIDTH;NOT_TESTED_OK" >UWIDTH ; NOT TESTED_OK</a></td><td class=SDescription>( This word returns the width (in characters) of an unsigned number in the current base )</td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#U.R(u+n--);NOT_TESTED_OK" >U.<wbr>R  ( u +n -- ) ; NOT TESTED_OK</a></td><td class=SDescription>Prints an unsigned number in fixed width field</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#R(n+n--)TESTED_OK(noch_nicht_alles_getestet)" >.R  ( n +n -- )  TESTED_OK (noch nicht alles getestet)</a></td><td class=SDescription>Displays a number in a fixed width field</td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#(n--);TESTED_OK" >.  ( n  -- ) ;  TESTED_OK</a></td><td class=SDescription>Displays a number</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#(adr--);TESTED_OK" >?  ( adr  -- ) ;  TESTED_OK</a></td><td class=SDescription>( ? </td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#WITHIN(n_min_max--f);TESTED_OK" >WITHIN  ( n min max -- f ) ;  TESTED_OK</a></td><td class=SDescription>True if n &lt;= x &lt; max</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#ALIGNED(adr1--adr2);NOT_TESTED_OK" >ALIGNED  ( adr1 -- adr2 ) ; NOT TESTED_OK</a></td><td class=SDescription>Adjusts an address to a machine word boundary</td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#ALIGN(--);NOT_TESTED_OK_rename!!!" >ALIGN  ( -- ) ; NOT TESTED_OK rename !!!</a></td><td class=SDescription>ALIGN aligns the HERE pointer, so the next word appended will be aligned properly.</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#C,;NOT_TESTED_OK_rename!!!" >C, ; NOT TESTED_OK rename !!!</a></td><td class=SDescription>define as high level word in rest.s ( C, appends a byte to the current compiled word. </td></tr><tr class="SFunction SIndent1 SMarked"><td class=SEntry><a href="#S;NOT_TESTED_OK_rename!!!" >S&rdquo; ; NOT TESTED_OK rename !!!</a></td><td class=SDescription>define as high level word in rest.s</td></tr><tr class="SFunction SIndent1"><td class=SEntry><a href="#;NOT_TESTED_OK" >.&rdquo; ; NOT TESTED_OK</a></td><td class=SDescription>; define as high level word in rest.s</td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Functions"></a>Functions</h3></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="U.(u--)TESTED_OK"></a>U.&nbsp; ( u -- ) TESTED_OK</h3><div class=CBody><p>Displays an unsigned number</p><blockquote><pre>( This is the underlying recursive definition of U. )
: U.        ( u -- )
BASE @ /MOD ( width rem quot )
?DUP IF         ( if quotient &lt;&gt; 0 then )
    RECURSE     ( print the quotient )
THEN
( print the remainder )
DUP 10 &lt; IF
    '0'     ( decimal digits 0..9 )
ELSE
    10 -        ( hex and beyond digits A..Z )
    'A'
THEN
+
EMIT</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="S(--)TESTED_OK"></a>.S  ( -- )  TESTED_OK</h3><div class=CBody><p>FORTH word .S prints the contents of the stack.&nbsp;  It doesn&rsquo;t alter the stack.&nbsp; Very useful for debugging.&nbsp; ;</p><blockquote><pre>: .S        ( -- )
DSP@        ( get current stack pointer )
BEGIN
    DUP S0 @ &lt;
WHILE
    DUP @ U.    ( print the stack element )
    SPACE
    4+      ( move up )
REPEAT
DROP</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ID.(anf--)TESTED_OK"></a>ID.&nbsp; ( anf -- )  TESTED_OK</h3><div class=CBody><p>Displays the name of a word from its name field address</p><blockquote><pre>: ID. 4+        ( skip over the link pointer )
DUP C@      ( get the flags/length byte )
F_LENMASK AND   ( mask out the flags - just want the length )
BEGIN
    DUP 0&gt;      ( length &gt; 0? )
WHILE
    SWAP 1+     ( addr len -- len addr+1 )
    DUP C@      ( len addr -- len addr char | get the next character)
    EMIT        ( len addr char -- len addr | and print it)
    SWAP 1-     ( len addr -- addr len-1    | subtract one from length )
REPEAT
2DROP       ( len addr -- )</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="HIDDEN(--)NOT_TESTED_OK"></a>?HIDDEN  ( --) NOT TESTED_OK</h3><div class=CBody><p>Vocabulary containing words used only to implement other words</p><blockquote><pre>: ?HIDDEN
4+      ( skip over the link pointer )
C@      ( get the flags/length byte )
F_HIDDEN AND    ( mask the F_HIDDEN flag and return it (as a truth value)</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="IMMEDIATE_NOT_TESTED_OK"></a>?IMMEDIATE NOT TESTED_OK</h3><div class=CBody><p>?IMMEDIATE</p><blockquote><pre>: ?IMMEDIATE
4+      ( skip over the link pointer )
C@      ( get the flags/length byte )
F_IMMED AND ( mask the F_IMMED flag and return it (as a truth value) )</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="WORDS(--)TESTED_OK"></a>WORDS ( -- )  TESTED_OK</h3><div class=CBody><p>Displays the words in the context vocabulary</p><blockquote><pre>: WORDS
LATEST @    ( start at LATEST dictionary entry )
BEGIN
    ?DUP        ( while link pointer is not null )
WHILE
    DUP ?HIDDEN NOT IF  ( ignore hidden words )
        DUP ID.     ( but if not hidden, print the word )
        SPACE
    THEN
    @       ( dereference the link pointer - go to previous word )
REPEAT
CR</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="FORGET;(NOT)TESTED_OK"></a>FORGET ; (NOT) TESTED_OK</h3><div class=CBody><p>&rsquo;FORGET word&rsquo; deletes the definition of &lsquo;word&rsquo; from the dictionary and everything defined after it, including any variables and other memory allocated after.</p><blockquote><pre>***********NOTE  to simple works well only for the lastest word. 'FORGET' words from middle of
***********dictionary , and the words after could not be used !!
 : FORGET
 WORD FIND   ( find the word, gets the dictionary entry address )
 DUP @ LATEST !  ( set LATEST to point to the previous word )
 HERE !      ( and store HERE with the dictionary address )</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="UWIDTH;NOT_TESTED_OK"></a>UWIDTH ; NOT TESTED_OK</h3><div class=CBody><p>( This word returns the width (in characters) of an unsigned number in the current base )</p><blockquote><pre>: UWIDTH    ( u -- width )
BASE @ /    ( rem quot )
?DUP IF     ( if quotient &lt;&gt; 0 then )
    RECURSE 1+  ( return 1+recursive call )
ELSE
    1       ( return 1 )
THEN</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="U.R(u+n--);NOT_TESTED_OK"></a>U.<wbr>R  ( u +n -- ) ; NOT TESTED_OK</h3><div class=CBody><p>Prints an unsigned number in fixed width field</p><blockquote><pre>: U.R       ( u width -- )
SWAP        ( width u )
DUP     ( width u u )
UWIDTH      ( width u uwidth )
ROT     ( u uwidth width )
SWAP -      ( u width-uwidth )
( At this point if the requested width is narrower, we'll have a negative number on the stack.
  Otherwise the number on the stack is the number of spaces to print.  But SPACES won't print
  a negative number of spaces anyway, so it's now safe to call SPACES ... )
SPACES
( ... and then call the underlying implementation of U. )
U.</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="R(n+n--)TESTED_OK(noch_nicht_alles_getestet)"></a>.R  ( n +n -- )  TESTED_OK (noch nicht alles getestet)</h3><div class=CBody><p>Displays a number in a fixed width field</p><blockquote><pre>.R prints a signed number, padded to a certain width.  We can't just print the sign
and call U.R because we want the sign to be next to the number ('-123' instead of '-  123').
: .R        ( n width -- )
SWAP        ( width n )
DUP 0&lt; IF
    NEGATE      ( width u )
    1       ( save a flag to remember that it was negative | width n 1 )
    SWAP        ( width 1 u )
    ROT     ( 1 u width )
    1-      ( 1 u width-1 )
ELSE
    0       ( width u 0 )
    SWAP        ( width 0 u )
    ROT     ( 0 u width )
THEN
SWAP        ( flag width u )
DUP     ( flag width u u )
UWIDTH      ( flag width u uwidth )
ROT     ( flag u uwidth width )
SWAP -      ( flag u width-uwidth )
SPACES      ( flag u )
SWAP        ( u flag )
IF          ( was it negative? print the - character )
    '-' EMIT
THEN
U.</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="(n--);TESTED_OK"></a>.  ( n  -- ) ;  TESTED_OK</h3><div class=CBody><p>Displays a number</p><blockquote><pre>: . 0 .R SPACE ;</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="(adr--);TESTED_OK"></a>?  ( adr  -- ) ;  TESTED_OK</h3><div class=CBody><p>( ? fetches the integer at an address and prints it.&nbsp; )</p><blockquote><pre>: ? ( addr -- ) @ . ;</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="WITHIN(n_min_max--f);TESTED_OK"></a>WITHIN  ( n min max -- f ) ;  TESTED_OK</h3><div class=CBody><p>True if n &lt;= x &lt; max</p><blockquote><pre>( c a b WITHIN returns true if a &lt;= c and c &lt; b )
(  or define without ifs: OVER - &gt;R - R&gt;  U&lt;  )
: WITHIN
-ROT        ( b c a )
OVER        ( b c a c )
&lt;= IF
    &gt; IF        ( b c -- )
        TRUE
    ELSE
        FALSE
    THEN
ELSE
    2DROP       ( b c -- )
    FALSE
THEN</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ALIGNED(adr1--adr2);NOT_TESTED_OK"></a>ALIGNED  ( adr1 -- adr2 ) ; NOT TESTED_OK</h3><div class=CBody><p>Adjusts an address to a machine word boundary</p><blockquote><pre>ALIGNED takes an address and rounds it up (aligns it) to the next 4 byte boundary.
: ALIGNED   ( addr -- addr )
3 + 3 INVERT AND    ( (addr+3) &amp; ~3 )</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="ALIGN(--);NOT_TESTED_OK_rename!!!"></a>ALIGN  ( -- ) ; NOT TESTED_OK rename !!!</h3><div class=CBody><p>ALIGN aligns the HERE pointer, so the next word appended will be aligned properly.</p><blockquote><pre>: ALIGN HERE @ ALIGNED HERE ! ;</pre></blockquote><p>defword ALI , ALI ,0</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="C,;NOT_TESTED_OK_rename!!!"></a>C, ; NOT TESTED_OK rename !!!</h3><div class=CBody><p>define as high level word in rest.s ( C, appends a byte to the current compiled word.&nbsp; )</p><blockquote><pre>: C,
HERE @ C!   ( store the character in the compiled image )
1 HERE +!   ( increment HERE pointer by 1 byte )</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="S;NOT_TESTED_OK_rename!!!"></a>S&rdquo; ; NOT TESTED_OK rename !!!</h3><div class=CBody><p>define as high level word in rest.s</p><blockquote><pre>: S&quot; IMMEDIATE      ( -- addr len )
STATE @ IF  ( compiling? )
    ' LITSTRING ,   ( compile LITSTRING )
    HERE @      ( save the address of the length word on the stack )
    0 ,     ( dummy length - we don't know what it is yet )
    BEGIN
        KEY         ( get next character of the string )
        DUP '&quot;' &lt;&gt;
    WHILE
        C,      ( copy character )
    REPEAT
    DROP        ( drop the double quote character at the end )
    DUP     ( get the saved address of the length word )
    HERE @ SWAP -   ( calculate the length )
    4-      ( subtract 4 (because we measured from the start of the length word) )
    SWAP !      ( and back-fill the length location )
    ALIGN       ( round up to next multiple of 4 bytes for the remaining code )
ELSE        ( immediate mode )
    HERE @      ( get the start address of the temporary space )
    BEGIN
        KEY
        DUP '&quot;' &lt;&gt;
    WHILE
        OVER C!     ( save next character )
        1+      ( increment address )
    REPEAT
    DROP        ( drop the final &quot; character )
    HERE @ -    ( calculate the length )
    HERE @      ( push the start address )
    SWAP        ( addr len )
THEN</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name=";NOT_TESTED_OK"></a>.&rdquo; ; NOT TESTED_OK</h3><div class=CBody><p>; define as high level word in rest.s</p><blockquote><pre>: .&quot; IMMEDIATE      ( -- )
STATE @ IF  ( compiling? )
    [COMPILE] S&quot;    ( read the string, and compile LITSTRING, etc. )
    ' TELL ,    ( compile the final TELL )
ELSE
    ( In immediate mode, just read characters and print them until we get
      to the ending double quote. )
    BEGIN
        KEY1
        DUP '&quot;' = IF
            DROP    ( drop the double quote character )
            EXIT    ( return from this function )
        THEN
        EMIT
    AGAIN
THEN
    begin</pre></blockquote></div></div></div>

</div><!--Content-->


<div id=Footer><a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div class=MEntry><div class=MFile><a href="ext-s.html">ext</a></div></div><div class=MEntry><div class=MFile><a href="ext1-s.html">ext1</a></div></div><div class=MEntry><div class=MFile id=MSelected>ext2</div></div><div class=MEntry><div class=MFile><a href="ext3-s.html">ext3</a></div></div><div class=MEntry><div class=MFile><a href="forth_core-s.html">forth_core</a></div></div><div class=MEntry><div class=MFile><a href="forth_macros-s.html">forth_macros</a></div></div><div class=MEntry><div class=MFile><a href="forth_words-s.html">forth_words</a></div></div><div class=MEntry><div class=MFile><a href="kernel-s.html">kernel</a></div></div><div class=MEntry><div class=MFile><a href="kernel_video-s.html">kernel_video</a></div></div><div class=MEntry><div class=MFile><a href="LICENSE-txt.html">License</a></div></div><div class=MEntry><div class=MFile><a href="rest-s.html">rest</a></div></div><div class=MEntry><div class=MFile><a href="boot-s.html">Starting point of OS</a></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Index</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MIndex><a href="../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Constants.html">Constants</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Files.html">Files</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Macros.html">Macros</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Variables.html">Variables</a></div></div></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Constants">Constants</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="Macros">Macros</option><option value="Variables">Variables</option></select></div></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<!--END_ND_TOOLTIPS-->




<div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div>


<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>